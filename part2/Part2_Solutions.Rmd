---
title: "Biostat 777 - Part 2: Linux Command Line Data Analysis"
author: "Jiayi Chu"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    theme: cosmo
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

# Part 2: Linux Command Line Exercises

## Task 1: Download the file using `wget` or `curl`

**Problem:** Download the `students.csv` file locally from the given URL.

**Solution:**
```{r, eval=FALSE}
curl -o students.csv https://example.com/students.csv
wget https://example.com/students.csv -O students.csv
```

---

## Task 2: Display the contents of the `students.csv` file using `cat`

**Problem:** Show all contents of the CSV file.

**Solution:**
```{r, eval=FALSE}
cat students.csv
```

**Output:**
```
ID,Name,Age,Gender,Grade,Subject
1,Alice,20,F,88,Math
2,Bob,22,M,76,History
3,Charlie,23,M,90,Math
4,Diana,21,F,85,Science
5,Eve,20,F,92,Math
6,Frank,22,M,72,History
7,Grace,23,F,78,Science
8,Heidi,21,F,88,Math
9,Ivan,20,M,85,Science
10,Judy,22,F,79,History
```

---

## Task 3: Display only the first 5 lines using `head`

**Problem:** Show the first 5 lines of the file.

**Solution:**
```{r, eval=FALSE}
head -5 students.csv
```

**Output:**
```
ID,Name,Age,Gender,Grade,Subject
1,Alice,20,F,88,Math
2,Bob,22,M,76,History
3,Charlie,23,M,90,Math
4,Diana,21,F,85,Science
```

---

## Task 4: Display only the last 3 lines using `tail`

**Problem:** Show the last 3 lines of the file.

**Solution:**
```{r, eval=FALSE}
tail -3 students.csv
```

**Output:**
```
8,Heidi,21,F,88,Math
9,Ivan,20,M,85,Science
10,Judy,22,F,79,History
```

---

## Task 5: Count the number of lines using `wc`

**Problem:** How many lines are in the file?

**Solution:**
```{r, eval=FALSE}
wc -l students.csv
```

**Output:**
```
      11 students.csv
```

The file has 11 lines total (1 header + 10 data rows).

---

## Task 6: Find all students taking "Math" using `grep`

**Problem:** Filter and display all students whose subject is "Math".

**Solution:**
```{r, eval=FALSE}
grep "Math" students.csv
```

**Output:**
```
1,Alice,20,F,88,Math
3,Charlie,23,M,90,Math
5,Eve,20,F,92,Math
8,Heidi,21,F,88,Math
```

Found 4 students taking Math.

---

## Task 7: Find all female students using `grep` or `awk`

**Problem:** Filter and display all female students (Gender = F).

**Solution:**
```{r, eval=FALSE}
# Using grep
grep ",F," students.csv

# Or using awk
awk -F',' '$4 == "F"' students.csv
```

**Output:**
```
1,Alice,20,F,88,Math
4,Diana,21,F,85,Science
5,Eve,20,F,92,Math
7,Grace,23,F,78,Science
8,Heidi,21,F,88,Math
10,Judy,22,F,79,History
```

Found 6 female students.

---

## Task 8: Sort by Age in ascending order using `sort`

**Problem:** Sort the students by their age from youngest to oldest.

**Solution:**
```{r, eval=FALSE}
head -1 students.csv && tail -n +2 students.csv | sort -t',' -k3 -n
```

**Output:**
```
ID,Name,Age,Gender,Grade,Subject
1,Alice,20,F,88,Math
5,Eve,20,F,92,Math
9,Ivan,20,M,85,Science
4,Diana,21,F,85,Science
8,Heidi,21,F,88,Math
10,Judy,22,F,79,History
2,Bob,22,M,76,History
6,Frank,22,M,72,History
3,Charlie,23,M,90,Math
7,Grace,23,F,78,Science
```

**Explanation:** 
- `head -1` keeps the header row first
- `tail -n +2` gets all data rows
- `sort -t',' -k3 -n` sorts by column 3 (Age) numerically

---

## Task 9: Find unique subjects using `cut`, `sort`, and `uniq`

**Problem:** What are the unique subjects in the dataset?

**Solution:**
```{r, eval=FALSE}
tail -n +2 students.csv | cut -d',' -f6 | sort | uniq
```

**Output:**
```
History
Math
Science
```

There are 3 unique subjects.

---

## Task 10: Calculate average grade using `awk`

**Problem:** What is the average grade of all students?

**Solution:**
```{r, eval=FALSE}
awk -F',' 'NR>1 {sum+=$5; count++} END {print "Average Grade:", sum/count}' students.csv
```

**Output:**
```
Average Grade: 83.3
```

**Explanation:**
- `-F','` sets field separator to comma
- `NR>1` skips the header row
- `$5` accesses the Grade column
- Calculates: (88+76+90+85+92+72+78+88+85+79) / 10 = 83.3

---

## Task 11: Replace text using `sed`

**Problem:** Replace all occurrences of "Math" with "Mathematics" in the file.

**Solution:**
```{r, eval=FALSE}
sed 's/Math/Mathematics/g' students.csv
```

**Output:**
```
ID,Name,Age,Gender,Grade,Subject
1,Alice,20,F,88,Mathematics
2,Bob,22,M,76,History
3,Charlie,23,M,90,Mathematics
4,Diana,21,F,85,Science
5,Eve,20,F,92,Mathematics
6,Frank,22,M,72,History
7,Grace,23,F,78,Science
8,Heidi,21,F,88,Mathematics
9,Ivan,20,M,85,Science
10,Judy,22,F,79,History
```

**Explanation:**
- `s/Math/Mathematics/g` substitutes all occurrences globally
- This displays output without modifying the original file

---

## Task 12: Create a shell script with all commands

**Problem:** Put all the commands into a shell script (`.sh`) file and run it.

**Solution:**
```{r, eval=FALSE}
cat > student_analysis.sh << 'EOF'
#!/bin/bash

echo "==============================================="
echo "STUDENT DATA ANALYSIS - PART 2"
echo "==============================================="
echo ""

echo "1. DISPLAYING FILE CONTENTS:"
echo "-----------------------------------"
cat students.csv
echo ""

echo "2. FIRST 5 LINES OF THE FILE:"
echo "-----------------------------------"
head -5 students.csv
echo ""

echo "3. LAST 3 LINES OF THE FILE:"
echo "-----------------------------------"
tail -3 students.csv
echo ""

echo "4. LINE COUNT:"
echo "-----------------------------------"
echo "Total lines: $(wc -l < students.csv)"
echo ""

echo "5. STUDENTS TAKING MATH:"
echo "-----------------------------------"
grep "Math" students.csv
echo ""

echo "6. FEMALE STUDENTS:"
echo "-----------------------------------"
grep ",F," students.csv
echo ""

echo "7. STUDENTS SORTED BY AGE (ASCENDING):"
echo "-----------------------------------"
head -1 students.csv
tail -n +2 students.csv | sort -t',' -k3 -n
echo ""

echo "8. UNIQUE SUBJECTS:"
echo "-----------------------------------"
tail -n +2 students.csv | cut -d',' -f6 | sort | uniq
echo ""

echo "9. AVERAGE GRADE:"
echo "-----------------------------------"
awk -F',' 'NR>1 {sum+=$5; count++} END {printf "Average Grade: %.2f\n", sum/count}' students.csv
echo ""

echo "10. FILE WITH 'MATH' REPLACED BY 'MATHEMATICS':"
echo "-----------------------------------"
sed 's/Math/Mathematics/g' students.csv
echo ""

echo "==============================================="
echo "END OF ANALYSIS"
echo "==============================================="
EOF
```

**Running the script:**
```{r, eval=FALSE}
chmod +x student_analysis.sh
./student_analysis.sh
```

